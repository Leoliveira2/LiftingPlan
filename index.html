<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lifting Plan Monitor - Liebherr</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    canvas {
      touch-action: none;
      cursor: crosshair;
    }
    .status-danger { 
      animation: pulse 2s infinite; 
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }
    .input {
      @apply px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent w-full transition-all duration-200;
    }
    input[type="range"] {
      -webkit-appearance: none;
      appearance: none;
      background: transparent;
      cursor: pointer;
    }
    input[type="range"]::-webkit-slider-track {
      background: #e2e8f0;
      height: 8px;
      border-radius: 4px;
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      background: #3b82f6;
      height: 20px;
      width: 20px;
      border-radius: 50%;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
  </style>
</head>
<body class="bg-slate-100">
  <div id="root"></div>
  <script type="text/babel">
    // C√ìDIGO COMPLETO DO APP

const { useState, useRef, useEffect } = React;

const App = () => {
  const [screen, setScreen] = useState('setup');
  const [equipment, setEquipment] = useState({ 
    model: 'Liebherr LTM 1220-5.2', 
    maxCapacity: '220000', 
    minRadius: '3', 
    maxRadius: '30' 
  });
  const [load, setLoad] = useState({ 
    weight: '15000', 
    description: 'Viga met√°lica estrutural' 
  });
  const [crane, setCrane] = useState({ radius: 8, angle: 45 });
  const [isDragging, setIsDragging] = useState(false);
  const canvasRef = useRef(null);

  const capacityTable = {
    3: 220000, 4: 150000, 5: 105000, 6: 78000, 7: 60000,
    8: 47000, 9: 38000, 10: 31000, 12: 22000, 14: 16500,
    16: 12800, 18: 10200, 20: 8400, 22: 7200, 24: 6200,
    26: 5400, 28: 4700, 30: 4100
  };

  const getCapacityAtRadius = (radius) => {
    const r = Math.round(radius);
    return capacityTable[r] || 0;
  };

  const getLoadStatus = () => {
    const capacity = getCapacityAtRadius(crane.radius);
    const weight = parseFloat(load.weight) || 0;
    const perc = (weight / capacity) * 100;
    if (perc > 100) return { status: 'danger', message: `‚ö†Ô∏è SOBRECARGA CR√çTICA! ${perc.toFixed(1)}%`, percentage: perc };
    if (perc >= 90) return { status: 'critical', message: `üî¥ MUITO PERIGOSO! ${perc.toFixed(1)}%`, percentage: perc };
    if (perc >= 75) return { status: 'warning', message: `‚ö†Ô∏è ATEN√á√ÉO! ${perc.toFixed(1)}%`, percentage: perc };
    if (perc >= 50) return { status: 'caution', message: `üü° CUIDADO! ${perc.toFixed(1)}%`, percentage: perc };
    return { status: 'safe', message: `‚úÖ SEGURO - ${perc.toFixed(1)}%`, percentage: perc };
  };

  const drawCrane = () => {
    const canvas = canvasRef.current;
    if (!canvas) return;
    const ctx = canvas.getContext('2d');
    const w = canvas.width = canvas.clientWidth;
    const h = canvas.height = 500;
    const cx = w / 2;
    const cy = h - 60;
    const scale = Math.min(w, h) / 50;
    ctx.clearRect(0, 0, w, h);
    ctx.fillStyle = '#f8fafc';
    ctx.fillRect(0, 0, w, h);
    ctx.fillStyle = '#6B7280';
    ctx.fillRect(cx - 6, cy - 100, 12, 100);
    const boomLength = crane.radius * scale;
    const boomAngle = Math.max(10, Math.min(85, crane.angle)) * Math.PI / 180;
    const pivotX = cx;
    const pivotY = cy - 100;
    const endX = pivotX + Math.cos(boomAngle) * boomLength;
    const endY = pivotY - Math.sin(boomAngle) * boomLength;
    const status = getLoadStatus();
    ctx.strokeStyle = {
      'danger': '#dc2626', 'critical': '#b91c1c', 'warning': '#f59e0b',
      'caution': '#eab308', 'safe': '#10b981'
    }[status.status] || '#2563EB';
    ctx.lineWidth = 8;
    ctx.beginPath();
    ctx.moveTo(pivotX, pivotY);
    ctx.lineTo(endX, endY);
    ctx.stroke();
  };

  useEffect(() => { drawCrane(); }, [crane, load]);

  const updateCrane = (e) => {
    const rect = canvasRef.current.getBoundingClientRect();
    const cx = canvasRef.current.width / 2;
    const cy = canvasRef.current.height - 60;
    const scale = Math.min(canvasRef.current.width, canvasRef.current.height) / 50;
    const mx = (e.clientX || e.touches?.[0]?.clientX) - rect.left;
    const my = (e.clientY || e.touches?.[0]?.clientY) - rect.top;
    const dx = mx - cx;
    const dy = cy - my;
    const radius = Math.sqrt(dx * dx + dy * dy) / scale;
    const angle = Math.atan2(dy, dx) * 180 / Math.PI;
    const minR = parseFloat(equipment.minRadius) || 3;
    const maxR = parseFloat(equipment.maxRadius) || 30;
    setCrane({
      radius: Math.max(minR, Math.min(maxR, radius)),
      angle: Math.min(85, Math.max(10, angle))
    });
  };

  const status = getLoadStatus();

  return screen === 'setup' ? (
    <div className="p-6">
      <h1 className="text-2xl font-bold mb-4">Configura√ß√£o do Guindaste</h1>
      <input className="input mb-2" placeholder="Modelo" value={equipment.model} onChange={e => setEquipment({ ...equipment, model: e.target.value })} />
      <input className="input mb-2" type="number" placeholder="Capacidade M√°xima (kg)" value={equipment.maxCapacity} onChange={e => setEquipment({ ...equipment, maxCapacity: e.target.value })} />
      <input className="input mb-2" type="number" placeholder="Raio M√≠nimo (m)" value={equipment.minRadius} onChange={e => setEquipment({ ...equipment, minRadius: e.target.value })} />
      <input className="input mb-2" type="number" placeholder="Raio M√°ximo (m)" value={equipment.maxRadius} onChange={e => setEquipment({ ...equipment, maxRadius: e.target.value })} />
      <input className="input mb-2" type="number" placeholder="Peso da Carga (kg)" value={load.weight} onChange={e => setLoad({ ...load, weight: e.target.value })} />
      <input className="input mb-4" placeholder="Descri√ß√£o da Carga" value={load.description} onChange={e => setLoad({ ...load, description: e.target.value })} />
      <button className="bg-blue-600 text-white px-6 py-3 rounded" onClick={() => setScreen('monitor')}>
        Iniciar Monitoramento
      </button>
    </div>
  ) : (
    <div className="p-6">
      <h1 className="text-2xl font-bold mb-4">Monitoramento: {equipment.model}</h1>
      <p className="mb-2">{load.description} - {(parseFloat(load.weight)/1000).toFixed(1)} t</p>
      <canvas
        ref={canvasRef}
        className="w-full border border-gray-300 rounded"
        height={500}
        onMouseDown={e => { setIsDragging(true); updateCrane(e); }}
        onMouseMove={e => isDragging && updateCrane(e)}
        onMouseUp={() => setIsDragging(false)}
        onMouseLeave={() => setIsDragging(false)}
        onTouchStart={e => { setIsDragging(true); updateCrane(e); }}
        onTouchMove={e => isDragging && updateCrane(e)}
        onTouchEnd={() => setIsDragging(false)}
      />
      <p className="mt-4 font-semibold">{status.message}</p>
      <p className="mt-1 text-sm text-gray-600">Raio: {crane.radius.toFixed(1)} m | √Çngulo: {crane.angle.toFixed(1)}¬∞</p>
      <p className="text-sm text-gray-600">Capacidade: {(getCapacityAtRadius(crane.radius)/1000).toFixed(1)} t</p>
      <button className="mt-4 bg-gray-500 text-white px-4 py-2 rounded" onClick={() => setScreen('setup')}>‚öôÔ∏è Reconfigurar</button>
    </div>
  );
};

ReactDOM.createRoot(document.getElementById("root")).render(<App />);
</script>
</body>
</html>
